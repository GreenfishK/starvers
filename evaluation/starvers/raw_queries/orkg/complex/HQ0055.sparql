PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX orkgr: <http://orkg.org/orkg/resource/>
PREFIX orkgc: <http://orkg.org/orkg/class/>
PREFIX orkgp: <http://orkg.org/orkg/predicate/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?rangeId ?energy_sources_labels (AVG(?eng_gen_value) AS ?avg_eng_gen_value)
WHERE {
  orkgr:R153801 orkgp:compareContribution ?contrib.
  ?paper orkgp:P31 ?contrib;
         orkgp:P29 ?year.
  BIND(xsd:int(?year) AS ?y).
  VALUES (?rangeId ?min ?max) {
    ("2001-2005" 2001 2005)
    ("2006-2010" 2006 2010)
    ("2011-2015" 2011 2015)
    ("2016-2020" 2016 2020)
  }
  FILTER(?min <= ?y && ?y <= ?max).
  ?contrib orkgp:P43135 ?energy_sources.
  ?energy_sources rdfs:label ?energy_sources_labels;
                  orkgp:P43134 ?energy_generation.
  ?energy_generation orkgp:HAS_VALUE ?value.
  BIND(xsd:float(?value) AS ?eng_gen_value).
}
ORDER BY ASC(?rangeId)
