SELECT ?rangeId ?energy_sources_labels (AVG(?eng_gen_value) AS ?avg_eng_gen_value)
WHERE {
  orkgr:R153801 orkgp:compareContribution ?contrib.
  ?paper orkgp:P31 ?contrib;
         orkgp:P29 ?year.
  BIND(xsd:int(?year) AS ?y).
  VALUES (?rangeId ?min ?max) {
    ("2001-2005" 2001 2005)
    ("2006-2010" 2006 2010)
    ("2011-2015" 2011 2015)
    ("2016-2020" 2016 2020)
  }
  FILTER(?min <= ?y && ?y <= ?max).
  ?contrib orkgp:P43135 ?energy_sources.
  ?energy_sources rdfs:label ?energy_sources_labels;
                  orkgp:P43134 ?energy_generation.
  ?energy_generation orkgp:HAS_VALUE ?value.
  BIND(xsd:float(?value) AS ?eng_gen_value).
}
ORDER BY ASC(?rangeId)
