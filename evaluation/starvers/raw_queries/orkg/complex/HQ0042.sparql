SELECT ?author_name
WHERE {
  {
    SELECT ?publication_date_ AS ?date_of_the_latest_paper {
      ?paper_ a orkgc:Paper;
              rdfs:label ?title_;
              orkgp:P28 ?publication_month_;
              orkgp:P29 ?publication_year_.
      OPTIONAL {
        ?publication_month_ rdfs:label ?publication_month_label_
      }
      OPTIONAL {
        ?publication_year_ rdfs:label ?publication_year_label_
      }
      BIND(
        xsd:integer(
          IF(
            BOUND(?publication_month_label_),
            ?publication_month_label_,
            ?publication_month_
          )
        ) AS ?publication_month_as_number_
      )
      BIND(
        xsd:integer(
          IF(
            BOUND(?publication_year_label_),
            ?publication_year_label_,
            ?publication_year_
          )
        ) AS ?publication_year_as_number_
      )
      BIND(
        xsd:dateTime(
          CONCAT(
            ?publication_year_as_number_,
            "-",
            ?publication_month_as_number_,
            "-01T00:00:00.000-00:00"
          )
        )
        AS ?publication_date_
      )
      FILTER(
        ?publication_month_as_number_ > 0 && ?publication_month_as_number_ < 13 && ?publication_year_as_number_ > 0 && ?publication_year_as_number_ < 2023
      )
      FILTER(REGEX(STR(?title_), "insect"))
    }
    ORDER BY DESC(?publication_date_)
    LIMIT 1
  }
  ?paper a orkgc:Paper;
           rdfs:label ?title;
           orkgp:P27 ?author;
           orkgp:P28 ?publication_month;
           orkgp:P29 ?publication_year.
  OPTIONAL {
     ?publication_month rdfs:label ?publication_month_label
  }
  OPTIONAL {
    ?publication_year rdfs:label ?publication_year_label
  }
  OPTIONAL {
    ?author rdfs:label ?author_label
  }
  BIND(
    IF(
      BOUND(?author_label),
      ?author_label,
      ?author
    ) AS ?author_name
  )
  BIND(
    xsd:integer(
      IF(
        BOUND(?publication_month_label),
        ?publication_month_label,
        ?publication_month
      )
    ) AS ?publication_month_as_number
  )
  BIND(
    xsd:integer(
      IF(
        BOUND(?publication_year_label),
        ?publication_year_label,
        ?publication_year
      )
    ) AS ?publication_year_as_number
  )
  BIND(
    xsd:dateTime(
      CONCAT(
        ?publication_year_as_number,
        "-",
        ?publication_month_as_number,
        "-01T00:00:00.000-00:00"
      )
    )
    AS ?publication_date
  )
  FILTER(
    ?publication_month_as_number > 0 && ?publication_month_as_number < 13 && ?publication_year_as_number > 0 && ?publication_year_as_number < 2023
  )
  FILTER(
    REGEX(
      STR(?title),
      "insect"
    ) && ?publication_date = ?date_of_the_latest_paper
  )
}
